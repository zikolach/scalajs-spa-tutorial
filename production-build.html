<!DOCTYPE HTML>
<html lang="en" >
    
    <head>
        
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <title>Production build | Scala.js SPA-tutorial</title>
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="generator" content="GitBook 2.5.2">
        
        
        <meta name="HandheldFriendly" content="true"/>
        <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="black">
        <link rel="apple-touch-icon-precomposed" sizes="152x152" href="gitbook/images/apple-touch-icon-precomposed-152.png">
        <link rel="shortcut icon" href="gitbook/images/favicon.ico" type="image/x-icon">
        
    <link rel="stylesheet" href="gitbook/style.css">
    
        
        <link rel="stylesheet" href="gitbook/plugins/gitbook-plugin-highlight/website.css">
        
    
        
        <link rel="stylesheet" href="gitbook/plugins/gitbook-plugin-search/search.css">
        
    
        
        <link rel="stylesheet" href="gitbook/plugins/gitbook-plugin-fontsettings/website.css">
        
    
    

        
    
    
    <link rel="next" href="./faq.html" />
    
    
    <link rel="prev" href="./using-resources-from-webjars.html" />
    

        
    </head>
    <body>
        
        
    <div class="book" data-level="6.2" data-chapter-title="Production build" data-filepath="production-build.md" data-basepath="." data-revision="Tue Apr 12 2016 23:08:14 GMT+0300 (FLE Daylight Time)">
    

<div class="book-summary">
    <nav role="navigation">
        <ul class="summary">
            
            
            
            

            

            
    
        <li class="chapter " data-level="0" data-path="index.html">
            
                
                    <a href="./index.html">
                
                        <i class="fa fa-check"></i>
                        
                        Introduction
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="1" data-path="getting-started.html">
            
                
                    <a href="./getting-started.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.</b>
                        
                        Getting started
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2" data-path="application-structure.html">
            
                
                    <a href="./application-structure.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.</b>
                        
                        Application structure
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.1" data-path="the-client.html">
            
                
                    <a href="./the-client.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.1.</b>
                        
                        The Client
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.1.1" data-path="routing.html">
            
                
                    <a href="./routing.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.1.1.</b>
                        
                        Routing
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.1.2" data-path="main-menu.html">
            
                
                    <a href="./main-menu.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.1.2.</b>
                        
                        Main menu
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.1.3" data-path="dashboard.html">
            
                
                    <a href="./dashboard.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.1.3.</b>
                        
                        Dashboard
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.1.4" data-path="css-in-scala.html">
            
                
                    <a href="./css-in-scala.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.1.4.</b>
                        
                        CSS in Scala
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.1.5" data-path="integrating-javascript-components.html">
            
                
                    <a href="./integrating-javascript-components.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.1.5.</b>
                        
                        Integrating JavaScript components
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.1.6" data-path="todo-module-and-data-flow.html">
            
                
                    <a href="./todo-module-and-data-flow.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.1.6.</b>
                        
                        Todo module and data flow
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.1.7" data-path="autowire-and-boopickle.html">
            
                
                    <a href="./autowire-and-boopickle.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.1.7.</b>
                        
                        Autowire and BooPickle
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2.2" data-path="server-side.html">
            
                
                    <a href="./server-side.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.2.</b>
                        
                        Server side
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="3" data-path="testing.html">
            
                
                    <a href="./testing.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.</b>
                        
                        Testing
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="4" data-path="debugging.html">
            
                
                    <a href="./debugging.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.</b>
                        
                        Debugging
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="5" data-path="logging.html">
            
                
                    <a href="./logging.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>5.</b>
                        
                        Logging
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="6" data-path="sbt-build-definition.html">
            
                
                    <a href="./sbt-build-definition.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>6.</b>
                        
                        SBT build definition
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="6.1" data-path="using-resources-from-webjars.html">
            
                
                    <a href="./using-resources-from-webjars.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>6.1.</b>
                        
                        Using resources from WebJars
                    </a>
            
            
        </li>
    
        <li class="chapter active" data-level="6.2" data-path="production-build.html">
            
                
                    <a href="./production-build.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>6.2.</b>
                        
                        Production build
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="7" data-path="faq.html">
            
                
                    <a href="./faq.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>7.</b>
                        
                        FAQ
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="8" data-path="what-next.html">
            
                
                    <a href="./what-next.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>8.</b>
                        
                        What next?
                    </a>
            
            
        </li>
    


            
            <li class="divider"></li>
            <li>
                <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
                    Published with GitBook
                </a>
            </li>
            
        </ul>
    </nav>
</div>

    <div class="book-body">
        <div class="body-inner">
            <div class="book-header" role="navigation">
    <!-- Actions Left -->
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="./" >Scala.js SPA-tutorial</a>
    </h1>
</div>

            <div class="page-wrapper" tabindex="-1" role="main">
                <div class="page-inner">
                
                
                    <section class="normal" id="section-">
                    
                        <h1 id="production-build">Production build</h1>
<p>So far we have been interested in having a nice and fast development cycle, without worrying about optimization. For your production release you&apos;ll want
to have a very optimized and small code-base to make the application perform well for the end user. To build an optimized version of the client application
you just need to use <code>fullOptJS</code> instead of <code>fastOptJS</code>. This will produce a JavaScript file with <code>-opt.js</code> extension, so the server must know to serve
this file instead of the non-optimized version. We are using @vmunier&apos;s <code>play-scalajs-scripts</code> to do this automatically within our HTML template.</p>
<h2 id="using-optimized-versions-of-js-libraries">Using optimized versions of JS libraries</h2>
<p>Typically JS libraries provided in WebJars come in two variants: normal and minified (<code>.min.js</code>). The latter is highly compressed and often also optimized
version of the more verbose normal version. For example debug-prints and development time checks have been removed. Therefore it makes sense to use these
pre-packaged minified versions instead of running the minification process yourself.</p>
<p>We need to define a separate JS dependencies for the production build, using the <code>minified</code> keyword:</p>
<pre><code class="lang-scala"><span class="hljs-comment">/** Dependencies for external JS libs that are bundled into a single .js file according to dependency order */</span>
<span class="hljs-function"><span class="hljs-keyword">val</span> <span class="hljs-title">jsDependencies</span> =</span> <span class="hljs-type">Def</span>.setting(<span class="hljs-type">Seq</span>(
  <span class="hljs-string">&quot;org.webjars.bower&quot;</span> % <span class="hljs-string">&quot;react&quot;</span> % versions.react / <span class="hljs-string">&quot;react-with-addons.js&quot;</span> minified <span class="hljs-string">&quot;react-with-addons.min.js&quot;</span> commonJSName <span class="hljs-string">&quot;React&quot;</span>,
  <span class="hljs-string">&quot;org.webjars.bower&quot;</span> % <span class="hljs-string">&quot;react&quot;</span> % versions.react / <span class="hljs-string">&quot;react-dom.js&quot;</span> minified <span class="hljs-string">&quot;react-dom.min.js&quot;</span> dependsOn <span class="hljs-string">&quot;react-with-addons.js&quot;</span> commonJSName <span class="hljs-string">&quot;ReactDOM&quot;</span>,
  <span class="hljs-string">&quot;org.webjars&quot;</span> % <span class="hljs-string">&quot;jquery&quot;</span> % versions.jQuery / <span class="hljs-string">&quot;jquery.js&quot;</span> minified <span class="hljs-string">&quot;jquery.min.js&quot;</span>,
  <span class="hljs-string">&quot;org.webjars&quot;</span> % <span class="hljs-string">&quot;bootstrap&quot;</span> % versions.bootstrap / <span class="hljs-string">&quot;bootstrap.js&quot;</span> minified <span class="hljs-string">&quot;bootstrap.min.js&quot;</span> dependsOn <span class="hljs-string">&quot;jquery.js&quot;</span>,
  <span class="hljs-string">&quot;org.webjars&quot;</span> % <span class="hljs-string">&quot;chartjs&quot;</span> % versions.chartjs / <span class="hljs-string">&quot;Chart.js&quot;</span> minified <span class="hljs-string">&quot;Chart.min.js&quot;</span>,
  <span class="hljs-string">&quot;org.webjars&quot;</span> % <span class="hljs-string">&quot;log4javascript&quot;</span> % versions.log4js / <span class="hljs-string">&quot;js/log4javascript_uncompressed.js&quot;</span> minified <span class="hljs-string">&quot;js/log4javascript.js&quot;</span>
))
</code></pre>
<p>Scala.js plugin will then automatically select the minified version when running <code>fullOptJS</code>.</p>
<h2 id="packaging-an-application">Packaging an application</h2>
<p>Play makes it very easy to package your application with the <code>dist</code> command. The plugins make sure client is complied with <code>fullOptJS</code> and all
relevant files end up in the distribution assets.</p>
<h2 id="automating-the-release-build">Automating the release build</h2>
<p>Even though we have all the pieces to build and package the application, it can be quite tedious to run several SBT commands one after another
to get everything done. That&apos;s what computers are really good at, so let&apos;s build a special <code>Command</code> to do the release. Here we also set
the <code>elideOptions</code> for client to get rid of any debug code.</p>
<pre><code class="lang-scala"><span class="hljs-keyword">lazy</span> <span class="hljs-function"><span class="hljs-keyword">val</span> <span class="hljs-title">ReleaseCmd</span> =</span> <span class="hljs-type">Command</span>.command(<span class="hljs-string">&quot;release&quot;</span>) {
  state =&gt; <span class="hljs-string">&quot;set elideOptions in client := Seq(\&quot;-Xelide-below\&quot;, \&quot;WARNING\&quot;)&quot;</span> ::
    <span class="hljs-string">&quot;client/clean&quot;</span> ::
    <span class="hljs-string">&quot;client/test&quot;</span> ::
    <span class="hljs-string">&quot;server/clean&quot;</span> ::
    <span class="hljs-string">&quot;server/test&quot;</span> ::
    <span class="hljs-string">&quot;server/dist&quot;</span> ::
    <span class="hljs-string">&quot;set elideOptions in client := Seq()&quot;</span> ::
    state
}
}
</code></pre>
<p>and enable it in the <code>server</code> project</p>
<pre><code class="lang-scala">  commands += <span class="hljs-type">ReleaseCmd</span>,
</code></pre>
<p>With this command, you can just execute <code>release</code> and SBT will run all those individual commands to build your application package.</p>

                    
                    </section>
                
                
                </div>
            </div>
        </div>

        
        <a href="./using-resources-from-webjars.html" class="navigation navigation-prev " aria-label="Previous page: Using resources from WebJars"><i class="fa fa-angle-left"></i></a>
        
        
        <a href="./faq.html" class="navigation navigation-next " aria-label="Next page: FAQ"><i class="fa fa-angle-right"></i></a>
        
    </div>
</div>

        
<script src="gitbook/app.js"></script>

    
    <script src="gitbook/plugins/gitbook-plugin-search/lunr.min.js"></script>
    

    
    <script src="gitbook/plugins/gitbook-plugin-search/search.js"></script>
    

    
    <script src="gitbook/plugins/gitbook-plugin-sharing/buttons.js"></script>
    

    
    <script src="gitbook/plugins/gitbook-plugin-fontsettings/buttons.js"></script>
    

<script>
require(["gitbook"], function(gitbook) {
    var config = {"highlight":{},"search":{},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2}};
    gitbook.start(config);
});
</script>

        
    </body>
    
</html>
